void expand_bitmap_safe(uint8_t *dst, size_t dst_sz, const uint8_t *src, unsigned src_w, unsigned scale) { unsigned dst_w = src_w * scale; if (dst_w > dst_sz) return; for (unsigned x = 0; x < dst_w; ++x) dst[x] = src[x / scale]; }