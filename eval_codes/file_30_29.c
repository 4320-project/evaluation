xmlDocPtr xmlSAXParseEntity(xmlSAXHandlerPtr sax, const char *filename) { xmlDocPtr ret; xmlParserCtxtPtr ctxt; ctxt = xmlCreateFileParserCtxt(filename); if (ctxt == NULL) { return(NULL); } if (sax != NULL) { if (sax->initialized == XML_SAX2_MAGIC) { *ctxt->sax = *sax; } else { memset(ctxt->sax, 0, sizeof(*ctxt->sax)); memcpy(ctxt->sax, sax, sizeof(xmlSAXHandlerV1)); } ctxt->userData = NULL; } xmlParseExtParsedEnt(ctxt); if (ctxt->wellFormed) { ret = ctxt->myDoc; } else { ret = NULL; xmlFreeDoc(ctxt->myDoc); } xmlFreeParserCtxt(ctxt); return(ret); }